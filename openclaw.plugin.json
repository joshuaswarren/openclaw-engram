{
  "id": "openclaw-engram",
  "kind": "memory",
  "configSchema": {
    "type": "object",
    "additionalProperties": false,
    "properties": {
      "openaiApiKey": {
        "type": "string",
        "description": "OpenAI API key (or set OPENAI_API_KEY env var)"
      },
      "openaiBaseUrl": {
        "type": "string",
        "description": "Override the OpenAI API base URL for OpenAI-compatible providers (Scryr, Together, OpenRouter, etc.)"
      },
      "model": {
        "type": "string",
        "default": "gpt-5.2",
        "description": "OpenAI model for extraction/consolidation"
      },
      "reasoningEffort": {
        "type": "string",
        "enum": ["none", "low", "medium", "high"],
        "default": "low",
        "description": "Reasoning effort for extraction"
      },
      "triggerMode": {
        "type": "string",
        "enum": ["smart", "every_n", "time_based"],
        "default": "smart",
        "description": "Buffer trigger mode"
      },
      "bufferMaxTurns": {
        "type": "number",
        "default": 5,
        "description": "Max turns before forced extraction"
      },
      "bufferMaxMinutes": {
        "type": "number",
        "default": 15,
        "description": "Max minutes before forced extraction"
      },
      "consolidateEveryN": {
        "type": "number",
        "default": 3,
        "description": "Run consolidation every N extractions"
      },
      "highSignalPatterns": {
        "type": "array",
        "items": { "type": "string" },
        "description": "Custom regex patterns for immediate extraction"
      },
      "maxMemoryTokens": {
        "type": "number",
        "default": 2000,
        "description": "Max tokens injected per turn"
      },
      "qmdEnabled": {
        "type": "boolean",
        "default": true,
        "description": "Use QMD for search"
      },
      "qmdCollection": {
        "type": "string",
        "default": "openclaw-engram",
        "description": "QMD collection name"
      },
      "qmdMaxResults": {
        "type": "number",
        "default": 8,
        "description": "Max QMD results per search"
      },
      "embeddingFallbackEnabled": {
        "type": "boolean",
        "default": true,
        "description": "Enable embedding-based semantic recall fallback when QMD is unavailable or returns no matches"
      },
      "embeddingFallbackProvider": {
        "type": "string",
        "enum": ["auto", "openai", "local"],
        "default": "auto",
        "description": "Embedding provider selection for semantic fallback"
      },
      "qmdPath": {
        "type": "string",
        "description": "Optional absolute path to qmd binary (bypasses PATH/fallback discovery)"
      },
      "memoryDir": {
        "type": "string",
        "description": "Override memory storage directory"
      },
      "debug": {
        "type": "boolean",
        "default": false,
        "description": "Enable debug logging"
      },
      "identityEnabled": {
        "type": "boolean",
        "default": true,
        "description": "Enable agent identity reflections (appends to workspace IDENTITY.md)"
      },
      "injectQuestions": {
        "type": "boolean",
        "default": false,
        "description": "Inject the most relevant open question into the system prompt"
      },
      "commitmentDecayDays": {
        "type": "number",
        "default": 90,
        "description": "Days before fulfilled/expired commitments are removed"
      },
      "workspaceDir": {
        "type": "string",
        "description": "Override workspace directory path"
      },
      "fileHygiene": {
        "type": "object",
        "additionalProperties": false,
        "description": "Optional: keep OpenClaw bootstrap workspace files small and warn before silent truncation risk.",
        "properties": {
          "enabled": {
            "type": "boolean",
            "default": false,
            "description": "Master switch for file hygiene (default off)."
          },
          "lintEnabled": {
            "type": "boolean",
            "default": true,
            "description": "If true, warn when bootstrap files approach budget."
          },
          "lintBudgetBytes": {
            "type": "number",
            "default": 20000,
            "description": "Budget in bytes used for lint warnings (approx)."
          },
          "lintWarnRatio": {
            "type": "number",
            "default": 0.8,
            "description": "Warn when file size >= budget * warnRatio."
          },
          "lintPaths": {
            "type": "array",
            "items": { "type": "string" },
            "default": ["IDENTITY.md", "MEMORY.md"],
            "description": "Workspace-relative paths to lint (or absolute paths)."
          },
          "rotateEnabled": {
            "type": "boolean",
            "default": false,
            "description": "If true, rotate oversized markdown files into an archive and replace with a lean index."
          },
          "rotateMaxBytes": {
            "type": "number",
            "default": 18000,
            "description": "Rotate when a target file exceeds this size (bytes)."
          },
          "rotateKeepTailChars": {
            "type": "number",
            "default": 2000,
            "description": "How many characters of the old file to keep inline (tail) for continuity."
          },
          "rotatePaths": {
            "type": "array",
            "items": { "type": "string" },
            "default": ["IDENTITY.md"],
            "description": "Workspace-relative paths to rotate (or absolute paths)."
          },
          "archiveDir": {
            "type": "string",
            "default": ".engram-archive",
            "description": "Workspace-relative archive directory where rotated files are stored."
          },
          "runMinIntervalMs": {
            "type": "number",
            "default": 300000,
            "description": "Minimum interval between hygiene runs (ms)."
          },
          "warningsLogEnabled": {
            "type": "boolean",
            "default": false,
            "description": "If true, append warnings to a log file under memoryDir."
          },
          "warningsLogPath": {
            "type": "string",
            "default": "hygiene/warnings.md",
            "description": "memoryDir-relative path to write warnings to."
          },
          "indexEnabled": {
            "type": "boolean",
            "default": false,
            "description": "Reserved: write an Engram index file in workspace (not required for rotation)."
          },
          "indexPath": {
            "type": "string",
            "default": "ENGRAM_INDEX.md",
            "description": "Workspace-relative index path (if indexEnabled)."
          }
        },
        "required": ["enabled"]
      },
      "accessTrackingEnabled": {
        "type": "boolean",
        "default": true,
        "description": "Track memory access counts and recency"
      },
      "accessTrackingBufferMaxSize": {
        "type": "number",
        "default": 100,
        "description": "Max entries in access tracking buffer before flush"
      },
      "recencyWeight": {
        "type": "number",
        "default": 0.2,
        "description": "Weight for recency boosting in search (0-1)"
      },
      "boostAccessCount": {
        "type": "boolean",
        "default": true,
        "description": "Boost frequently accessed memories in search results"
      },
      "recallPlannerEnabled": {
        "type": "boolean",
        "default": true,
        "description": "Use lightweight retrieve-vs-think planning to avoid unnecessary recall work."
      },
      "recallPlannerMaxQmdResultsMinimal": {
        "type": "number",
        "default": 4,
        "description": "QMD cap used when recall planner selects minimal mode."
      },
      "intentRoutingEnabled": {
        "type": "boolean",
        "default": false,
        "description": "Attach intent metadata to memories and boost compatible memories at recall."
      },
      "intentRoutingBoost": {
        "type": "number",
        "default": 0.12,
        "description": "Maximum score boost applied for intent-compatible memory matches."
      },
      "verbatimArtifactsEnabled": {
        "type": "boolean",
        "default": false,
        "description": "Write quote-first artifact anchors during extraction and include them in recall."
      },
      "verbatimArtifactsMinConfidence": {
        "type": "number",
        "default": 0.8,
        "description": "Minimum extraction confidence required before writing an artifact."
      },
      "verbatimArtifactsMaxRecall": {
        "type": "number",
        "default": 5,
        "description": "Maximum artifact anchors injected per recall."
      },
      "verbatimArtifactCategories": {
        "type": "array",
        "items": {
          "type": "string",
          "enum": ["fact", "preference", "correction", "entity", "decision", "relationship", "principle", "commitment", "moment", "skill"]
        },
        "default": ["decision", "correction", "principle", "commitment"],
        "description": "Memory categories eligible for artifact extraction."
      },
      "memoryBoxesEnabled": {
        "type": "boolean",
        "default": false,
        "description": "Enable Memory Boxes (v8.0 Phase 2A). Groups memories into topic-bounded windows. Disabled by default."
      },
      "boxTopicShiftThreshold": {
        "type": "number",
        "default": 0.35,
        "description": "Jaccard overlap threshold below which a topic shift seals the current box (0–1)."
      },
      "boxTimeGapMs": {
        "type": "number",
        "default": 1800000,
        "description": "Time gap in milliseconds before an open box is sealed (default 30 min)."
      },
      "boxMaxMemories": {
        "type": "number",
        "default": 50,
        "description": "Maximum memories per box before forced seal."
      },
      "traceWeaverEnabled": {
        "type": "boolean",
        "default": false,
        "description": "Enable Trace Weaving (v8.0 Phase 2A). Links recurring topic boxes with a shared traceId."
      },
      "traceWeaverLookbackDays": {
        "type": "number",
        "default": 7,
        "description": "Days back to search for trace links."
      },
      "traceWeaverOverlapThreshold": {
        "type": "number",
        "default": 0.4,
        "description": "Minimum Jaccard topic overlap to assign the same traceId (0–1)."
      },
      "boxRecallDays": {
        "type": "number",
        "default": 3,
        "description": "Number of recent days of boxes to inject during recall."
      },
      "queryExpansionEnabled": {
        "type": "boolean",
        "default": false,
        "description": "Enable heuristic query expansion for retrieval (no LLM calls)."
      },
      "queryExpansionMaxQueries": {
        "type": "number",
        "default": 4,
        "description": "Max expanded queries to run (including the original prompt)."
      },
      "queryExpansionMinTokenLen": {
        "type": "number",
        "default": 3,
        "description": "Minimum token length to include in heuristic query expansion."
      },
      "rerankEnabled": {
        "type": "boolean",
        "default": false,
        "description": "Enable LLM re-ranking of retrieved memories. Default off."
      },
      "rerankProvider": {
        "type": "string",
        "default": "local",
        "description": "Re-ranking provider: 'local' uses local LLM only. 'cloud' is reserved/experimental (currently treated as no-op).",
        "enum": ["local", "cloud"]
      },
      "rerankMaxCandidates": {
        "type": "number",
        "default": 20,
        "description": "Max candidates to send to the re-ranker."
      },
      "rerankTimeoutMs": {
        "type": "number",
        "default": 8000,
        "description": "Timeout for re-ranking requests (ms). Fail-open on timeout."
      },
      "rerankCacheEnabled": {
        "type": "boolean",
        "default": true,
        "description": "Cache re-ranking results in-memory for repeated queries."
      },
      "rerankCacheTtlMs": {
        "type": "number",
        "default": 3600000,
        "description": "TTL for in-memory re-ranking cache (ms)."
      },
      "feedbackEnabled": {
        "type": "boolean",
        "default": false,
        "description": "Enable feedback capture tool for memory relevance (thumbs up/down)."
      },
      "negativeExamplesEnabled": {
        "type": "boolean",
        "default": false,
        "description": "Enable negative examples (track retrieved-but-not-useful memories) and apply a small ranking penalty."
      },
      "negativeExamplesPenaltyPerHit": {
        "type": "number",
        "default": 0.05,
        "description": "Ranking penalty per negative example hit (keep small; QMD scores are ~0-1)."
      },
      "negativeExamplesPenaltyCap": {
        "type": "number",
        "default": 0.25,
        "description": "Maximum ranking penalty applied from negative examples."
      },
      "chunkingEnabled": {
        "type": "boolean",
        "default": false,
        "description": "Enable automatic chunking of long memories"
      },
      "chunkingTargetTokens": {
        "type": "number",
        "default": 200,
        "description": "Target tokens per chunk"
      },
      "chunkingMinTokens": {
        "type": "number",
        "default": 150,
        "description": "Minimum tokens to trigger chunking"
      },
      "chunkingOverlapSentences": {
        "type": "number",
        "default": 2,
        "description": "Number of sentences to overlap between chunks"
      },
      "contradictionDetectionEnabled": {
        "type": "boolean",
        "default": false,
        "description": "Enable automatic contradiction detection with LLM verification"
      },
      "contradictionSimilarityThreshold": {
        "type": "number",
        "default": 0.7,
        "description": "QMD similarity threshold to trigger contradiction check"
      },
      "contradictionMinConfidence": {
        "type": "number",
        "default": 0.9,
        "description": "Minimum LLM confidence to auto-resolve contradictions"
      },
      "contradictionAutoResolve": {
        "type": "boolean",
        "default": true,
        "description": "Automatically supersede contradicted memories"
      },
      "memoryLinkingEnabled": {
        "type": "boolean",
        "default": false,
        "description": "Enable automatic memory linking to build knowledge graph"
      },
      "threadingEnabled": {
        "type": "boolean",
        "default": false,
        "description": "Enable conversation threading"
      },
      "threadingGapMinutes": {
        "type": "number",
        "default": 30,
        "description": "Minutes of gap to start a new thread"
      },
      "summarizationEnabled": {
        "type": "boolean",
        "default": false,
        "description": "Enable automatic memory summarization/compression"
      },
      "summarizationTriggerCount": {
        "type": "number",
        "default": 1000,
        "description": "Memory count threshold to trigger summarization"
      },
      "summarizationRecentToKeep": {
        "type": "number",
        "default": 300,
        "description": "Number of recent memories to keep uncompressed"
      },
      "summarizationImportanceThreshold": {
        "type": "number",
        "default": 0.3,
        "description": "Only compress memories with importance below this threshold"
      },
      "summarizationProtectedTags": {
        "type": "array",
        "items": { "type": "string" },
        "default": ["commitment", "preference", "decision", "principle"],
        "description": "Tags that protect memories from compression"
      },
      "topicExtractionEnabled": {
        "type": "boolean",
        "default": true,
        "description": "Enable topic extraction during consolidation"
      },
      "topicExtractionTopN": {
        "type": "number",
        "default": 50,
        "description": "Number of top topics to extract"
      },
      "transcriptEnabled": {
        "type": "boolean",
        "default": true,
        "description": "Enable transcript archiving"
      },
      "transcriptRetentionDays": {
        "type": "number",
        "default": 7,
        "description": "Days to retain transcript entries"
      },
      "transcriptSkipChannelTypes": {
        "type": "array",
        "items": { "type": "string" },
        "default": ["cron"],
        "description": "Channel types to skip from transcript logging (e.g., cron)"
      },
      "transcriptRecallHours": {
        "type": "number",
        "default": 12,
        "description": "Hours of transcript history to recall"
      },
      "maxTranscriptTurns": {
        "type": "number",
        "default": 50,
        "description": "Maximum transcript turns to inject"
      },
      "maxTranscriptTokens": {
        "type": "number",
        "default": 1000,
        "description": "Maximum tokens for transcript injection"
      },
      "checkpointEnabled": {
        "type": "boolean",
        "default": true,
        "description": "Enable conversation checkpoints"
      },
      "checkpointTurns": {
        "type": "number",
        "default": 15,
        "description": "Number of turns per checkpoint"
      },
      "hourlySummariesEnabled": {
        "type": "boolean",
        "default": true,
        "description": "Enable hourly conversation summaries"
      },
      "summaryRecallHours": {
        "type": "number",
        "default": 24,
        "description": "Hours of summary history to recall"
      },
      "maxSummaryCount": {
        "type": "number",
        "default": 6,
        "description": "Maximum number of summaries to inject"
      },
      "summaryModel": {
        "type": "string",
        "description": "Model for hourly summaries (defaults to main model)"
      },
      "localLlmEnabled": {
        "type": "boolean",
        "default": false,
        "description": "Enable local LLM for extraction and summarization (e.g., LM Studio, Ollama)"
      },
      "localLlmUrl": {
        "type": "string",
        "default": "http://localhost:1234/v1",
        "description": "URL for local LLM OpenAI-compatible endpoint"
      },
      "localLlmModel": {
        "type": "string",
        "default": "local-model",
        "description": "Model name for local LLM requests"
      },
      "localLlmApiKey": {
        "type": "string",
        "description": "Optional API key for authenticated OpenAI-compatible local endpoints"
      },
      "localLlmHeaders": {
        "type": "object",
        "description": "Optional additional headers for local/compatible endpoint requests",
        "additionalProperties": {
          "type": "string"
        }
      },
      "localLlmAuthHeader": {
        "type": "boolean",
        "default": true,
        "description": "If false, do not send Authorization header even when localLlmApiKey is set"
      },
      "localLlmFallback": {
        "type": "boolean",
        "default": true,
        "description": "Fall back to cloud OpenAI if local LLM is unavailable"
      },
      "localLlmHomeDir": {
        "type": "string",
        "description": "Optional home directory override for local LLM helpers (LM Studio settings + CLI PATH resolution)."
      },
      "localLmsCliPath": {
        "type": "string",
        "description": "Optional absolute path to LMS CLI binary. Preferred over auto-detected locations."
      },
      "localLmsBinDir": {
        "type": "string",
        "description": "Optional bin directory prepended to PATH for LMS CLI execution."
      },
      "localLlmTimeoutMs": {
        "type": "number",
        "default": 180000,
        "description": "Hard timeout for local LLM requests (ms)"
      },
      "slowLogEnabled": {
        "type": "boolean",
        "default": false,
        "description": "If enabled, log slow operations (durations + metadata; never logs content)"
      },
      "slowLogThresholdMs": {
        "type": "number",
        "default": 30000,
        "description": "Threshold for slow operation logging (ms)"
      },
      "extractionDedupeEnabled": {
        "type": "boolean",
        "default": true,
        "description": "Enable deduplication of near-identical extraction batches within a time window."
      },
      "extractionDedupeWindowMs": {
        "type": "number",
        "default": 300000,
        "description": "Window for extraction dedupe fingerprints (ms)."
      },
      "extractionMinChars": {
        "type": "number",
        "default": 40,
        "description": "Minimum combined user/assistant characters required before extraction runs."
      },
      "extractionMinUserTurns": {
        "type": "number",
        "default": 1,
        "description": "Minimum number of user turns required before extraction runs."
      },
      "extractionMaxTurnChars": {
        "type": "number",
        "default": 4000,
        "description": "Maximum characters per turn fed to extraction (long turns are truncated)."
      },
      "extractionMaxFactsPerRun": {
        "type": "number",
        "default": 12,
        "description": "Maximum facts persisted from a single extraction run."
      },
      "extractionMaxEntitiesPerRun": {
        "type": "number",
        "default": 6,
        "description": "Maximum entities persisted from a single extraction run."
      },
      "extractionMaxQuestionsPerRun": {
        "type": "number",
        "default": 3,
        "description": "Maximum questions persisted from a single extraction run."
      },
      "extractionMaxProfileUpdatesPerRun": {
        "type": "number",
        "default": 4,
        "description": "Maximum profile updates persisted from a single extraction run."
      },
      "consolidationRequireNonZeroExtraction": {
        "type": "boolean",
        "default": true,
        "description": "Only schedule consolidation when the last extraction produced durable outputs."
      },
      "consolidationMinIntervalMs": {
        "type": "number",
        "default": 600000,
        "description": "Minimum interval between consolidation runs (ms)."
      },
      "qmdMaintenanceEnabled": {
        "type": "boolean",
        "default": true,
        "description": "Enable debounced background QMD maintenance instead of immediate updates on extraction."
      },
      "qmdMaintenanceDebounceMs": {
        "type": "number",
        "default": 30000,
        "description": "Debounce window for background QMD maintenance updates (ms)."
      },
      "qmdAutoEmbedEnabled": {
        "type": "boolean",
        "default": false,
        "description": "If true, background QMD maintenance also runs embed on a throttled cadence."
      },
      "qmdEmbedMinIntervalMs": {
        "type": "number",
        "default": 3600000,
        "description": "Minimum interval between background QMD embed runs (ms)."
      },
      "qmdUpdateTimeoutMs": {
        "type": "number",
        "default": 90000,
        "description": "Timeout for QMD update command (ms). Increase if your index grows and updates exceed 30s."
      },
      "localLlmRetry5xxCount": {
        "type": "number",
        "default": 1,
        "description": "Number of retry attempts for local LLM 5xx responses."
      },
      "localLlmRetryBackoffMs": {
        "type": "number",
        "default": 400,
        "description": "Base backoff delay between local LLM retries (ms)."
      },
      "localLlm400TripThreshold": {
        "type": "number",
        "default": 5,
        "description": "Consecutive 400 responses before local LLM enters temporary cooldown."
      },
      "localLlm400CooldownMs": {
        "type": "number",
        "default": 120000,
        "description": "Cooldown duration after tripping local LLM 400 threshold (ms)."
      },
      "localLlmMaxContext": {
        "type": "number",
        "description": "Override the detected context window for local LLM. Set to 32768 if your LLM server defaults to 32K context despite the model supporting 128K."
      },
      "hourlySummaryCronAutoRegister": {
        "type": "boolean",
        "default": false,
        "description": "If true, Engram may attempt to auto-register an hourly summary cron job (default off)."
      },
      "hourlySummariesExtendedEnabled": {
        "type": "boolean",
        "default": false,
        "description": "Enable structured hourly summaries (topics/decisions/action items/rejections). Default off."
      },
      "hourlySummariesIncludeToolStats": {
        "type": "boolean",
        "default": false,
        "description": "Include tool usage counts in extended hourly summaries (requires tool usage capture)."
      },
      "hourlySummariesIncludeSystemMessages": {
        "type": "boolean",
        "default": false,
        "description": "Include system messages in extended hourly summaries (use with care)."
      },
      "hourlySummariesMaxTurnsPerRun": {
        "type": "number",
        "default": 200,
        "description": "Maximum transcript turns to consider per session per hourly summarizer run."
      },
      "conversationIndexEnabled": {
        "type": "boolean",
        "default": false,
        "description": "Enable conversation chunk indexing + semantic recall hook (default off)."
      },
      "conversationIndexBackend": {
        "type": "string",
        "enum": ["qmd", "faiss"],
        "default": "qmd",
        "description": "Backend for conversation indexing. qmd indexes chunk docs; faiss reserved/experimental."
      },
      "conversationIndexQmdCollection": {
        "type": "string",
        "default": "openclaw-engram-conversations",
        "description": "QMD collection to use for conversation chunk search (must be configured in ~/.config/qmd/index.yml)."
      },
      "conversationIndexRetentionDays": {
        "type": "number",
        "default": 30,
        "description": "Days to retain conversation chunk docs."
      },
      "conversationIndexMinUpdateIntervalMs": {
        "type": "number",
        "default": 900000,
        "description": "Minimum interval between conversation_index_update runs per session (ms). Prevents redundant reindex churn."
      },
      "conversationIndexEmbedOnUpdate": {
        "type": "boolean",
        "default": false,
        "description": "If true, conversation_index_update also runs QMD embed by default. Keep false for lower load."
      },
      "conversationRecallTopK": {
        "type": "number",
        "default": 3,
        "description": "Top-K conversation chunks to inject."
      },
      "conversationRecallMaxChars": {
        "type": "number",
        "default": 2500,
        "description": "Max characters of semantic conversation recall to inject."
      },
      "conversationRecallTimeoutMs": {
        "type": "number",
        "default": 800,
        "description": "Timeout for semantic conversation recall search (ms). Fail-open on timeout."
      },
      "namespacesEnabled": {
        "type": "boolean",
        "default": false,
        "description": "Enable multi-agent namespaces (v3.0). Default off."
      },
      "defaultNamespace": {
        "type": "string",
        "default": "default",
        "description": "Default namespace name."
      },
      "sharedNamespace": {
        "type": "string",
        "default": "shared",
        "description": "Shared namespace name."
      },
      "principalFromSessionKeyMode": {
        "type": "string",
        "enum": ["map", "prefix", "regex"],
        "default": "map",
        "description": "How to derive principal identity from sessionKey."
      },
      "principalFromSessionKeyRules": {
        "type": "array",
        "description": "Rules for resolving principal from sessionKey (ordered).",
        "items": {
          "type": "object",
          "additionalProperties": false,
          "properties": {
            "match": { "type": "string" },
            "principal": { "type": "string" }
          },
          "required": ["match", "principal"]
        }
      },
      "namespacePolicies": {
        "type": "array",
        "description": "Namespace access policies.",
        "items": {
          "type": "object",
          "additionalProperties": false,
          "properties": {
            "name": { "type": "string" },
            "readPrincipals": { "type": "array", "items": { "type": "string" } },
            "writePrincipals": { "type": "array", "items": { "type": "string" } },
            "includeInRecallByDefault": { "type": "boolean" }
          },
          "required": ["name", "readPrincipals", "writePrincipals"]
        }
      },
      "defaultRecallNamespaces": {
        "type": "array",
        "description": "Which namespaces to include by default in recall.",
        "items": { "type": "string", "enum": ["self", "shared"] },
        "default": ["self", "shared"]
      },
      "autoPromoteToSharedEnabled": {
        "type": "boolean",
        "default": false,
        "description": "If enabled, Engram may auto-promote selected categories to shared (reserved; conservative)."
      },
      "autoPromoteToSharedCategories": {
        "type": "array",
        "items": { "type": "string", "enum": ["correction", "decision", "preference"] },
        "default": ["correction", "decision", "preference"],
        "description": "Categories eligible for auto-promotion to shared."
      },
      "autoPromoteMinConfidenceTier": {
        "type": "string",
        "enum": ["explicit", "implied"],
        "default": "explicit",
        "description": "Minimum confidence tier for auto-promotion."
      },
      "sharedContextEnabled": {
        "type": "boolean",
        "default": false,
        "description": "Enable shared-context injection + tools (v4.0). Default off."
      },
      "sharedContextDir": {
        "type": "string",
        "description": "Override shared-context directory (default: ~/.openclaw/workspace/shared-context)."
      },
      "sharedContextMaxInjectChars": {
        "type": "number",
        "default": 4000,
        "description": "Max characters of shared-context to inject into each prompt."
      },
      "crossSignalsSemanticEnabled": {
        "type": "boolean",
        "default": false,
        "description": "Enable semantic cross-signal grouping (reserved/experimental)."
      },
      "crossSignalsSemanticTimeoutMs": {
        "type": "number",
        "default": 4000,
        "description": "Timeout for semantic cross-signal grouping (ms)."
      },
      "compoundingEnabled": {
        "type": "boolean",
        "default": false,
        "description": "Enable compounding engine (v5.0). Default off."
      },
      "compoundingWeeklyCronEnabled": {
        "type": "boolean",
        "default": false,
        "description": "If true, compounding weekly synthesis can be scheduled externally via cron."
      },
      "compoundingSemanticEnabled": {
        "type": "boolean",
        "default": false,
        "description": "Enable semantic compounding synthesis (reserved/experimental)."
      },
      "compoundingSynthesisTimeoutMs": {
        "type": "number",
        "default": 15000,
        "description": "Timeout for compounding synthesis (ms)."
      },
      "compoundingInjectEnabled": {
        "type": "boolean",
        "default": true,
        "description": "Inject compounded mistakes/patterns into recall when compounding is enabled."
      },
      "factDeduplicationEnabled": {
        "type": "boolean",
        "default": true,
        "description": "Enable content-hash deduplication to prevent storing semantically identical facts."
      },
      "factArchivalEnabled": {
        "type": "boolean",
        "default": false,
        "description": "Enable automatic archival of old, low-importance, rarely-accessed facts during consolidation."
      },
      "factArchivalAgeDays": {
        "type": "number",
        "default": 90,
        "description": "Minimum age in days before a fact is eligible for archival."
      },
      "factArchivalMaxImportance": {
        "type": "number",
        "default": 0.3,
        "description": "Maximum importance score for archival eligibility (0-1). Only facts below this threshold are archived."
      },
      "factArchivalMaxAccessCount": {
        "type": "number",
        "default": 2,
        "description": "Maximum access count for archival eligibility. Only rarely-accessed facts are archived."
      },
      "factArchivalProtectedCategories": {
        "type": "array",
        "items": { "type": "string" },
        "default": ["commitment", "preference", "decision", "principle"],
        "description": "Categories that protect a fact from archival regardless of other criteria."
      },
      "qmdDaemonEnabled": {
        "type": "boolean",
        "default": true,
        "description": "Auto-detect and use QMD HTTP daemon for faster searches"
      },
      "qmdDaemonUrl": {
        "type": "string",
        "default": "http://localhost:8181/mcp",
        "description": "QMD HTTP daemon MCP endpoint URL"
      },
      "qmdDaemonRecheckIntervalMs": {
        "type": "number",
        "default": 60000,
        "description": "Re-probe interval when daemon is down (ms)"
      },
      "knowledgeIndexEnabled": {
        "type": "boolean",
        "default": true,
        "description": "Inject a compact Knowledge Index of top entities into every recall"
      },
      "knowledgeIndexMaxEntities": {
        "type": "number",
        "default": 40,
        "description": "Max entities included in the Knowledge Index"
      },
      "knowledgeIndexMaxChars": {
        "type": "number",
        "default": 4000,
        "description": "Hard character cap for the Knowledge Index section"
      },
      "entityRelationshipsEnabled": {
        "type": "boolean",
        "default": true,
        "description": "Track entity-to-entity relationships during extraction"
      },
      "entityActivityLogEnabled": {
        "type": "boolean",
        "default": true,
        "description": "Log timestamped activity per entity"
      },
      "entityActivityLogMaxEntries": {
        "type": "number",
        "default": 20,
        "description": "Max activity entries per entity before oldest are pruned"
      },
      "entityAliasesEnabled": {
        "type": "boolean",
        "default": true,
        "description": "Store aliases per entity file"
      },
      "entitySummaryEnabled": {
        "type": "boolean",
        "default": true,
        "description": "Generate LLM summaries for entities during consolidation"
      }
    }
  },
  "uiHints": {
    "openaiApiKey": {
      "label": "OpenAI API Key",
      "sensitive": true,
      "placeholder": "sk-...",
      "help": "API key for OpenAI (or use ${OPENAI_API_KEY})"
    },
    "openaiBaseUrl": {
      "label": "OpenAI Base URL",
      "advanced": true,
      "placeholder": "https://api.openai.com/v1",
      "help": "Override for OpenAI-compatible providers (Scryr, Together, OpenRouter, etc.)"
    },
    "model": {
      "label": "Extraction Model",
      "advanced": true,
      "placeholder": "gpt-5.2"
    },
    "reasoningEffort": {
      "label": "Reasoning Effort",
      "advanced": true
    },
    "triggerMode": {
      "label": "Trigger Mode",
      "advanced": true
    },
    "bufferMaxTurns": {
      "label": "Buffer Max Turns",
      "advanced": true,
      "placeholder": "5"
    },
    "bufferMaxMinutes": {
      "label": "Buffer Max Minutes",
      "advanced": true,
      "placeholder": "15"
    },
    "consolidateEveryN": {
      "label": "Consolidation Frequency",
      "advanced": true,
      "placeholder": "3"
    },
    "maxMemoryTokens": {
      "label": "Max Memory Tokens",
      "advanced": true,
      "placeholder": "2000"
    },
    "qmdEnabled": {
      "label": "Enable QMD",
      "help": "Enable QMD for memory search/indexing"
    },
    "qmdCollection": {
      "label": "QMD Collection",
      "advanced": true,
      "placeholder": "openclaw-engram"
    },
    "qmdMaxResults": {
      "label": "QMD Max Results",
      "advanced": true,
      "placeholder": "8"
    },
    "embeddingFallbackEnabled": {
      "label": "Embedding Fallback",
      "help": "Use semantic embeddings when QMD is unavailable or no results are found"
    },
    "embeddingFallbackProvider": {
      "label": "Embedding Provider",
      "advanced": true,
      "placeholder": "auto"
    },
    "qmdPath": {
      "label": "QMD Path",
      "advanced": true,
      "placeholder": "/opt/homebrew/bin/qmd",
      "help": "Optional absolute path to qmd binary for environments with unstable PATH/bun shims"
    },
    "memoryDir": {
      "label": "Memory Directory",
      "advanced": true,
      "placeholder": "~/.openclaw/workspace/memory/local"
    },
    "debug": {
      "label": "Debug Mode",
      "advanced": true
    },
    "identityEnabled": {
      "label": "Identity Reflections",
      "help": "Append self-reflections to workspace IDENTITY.md after each extraction"
    },
    "injectQuestions": {
      "label": "Inject Questions",
      "help": "Include the most relevant open question in the system prompt"
    },
    "commitmentDecayDays": {
      "label": "Commitment Decay (days)",
      "advanced": true,
      "placeholder": "90"
    },
    "workspaceDir": {
      "label": "Workspace Directory",
      "advanced": true,
      "placeholder": "~/.openclaw/workspace"
    },
    "accessTrackingEnabled": {
      "label": "Access Tracking",
      "help": "Track which memories are accessed most frequently"
    },
    "accessTrackingBufferMaxSize": {
      "label": "Access Buffer Size",
      "advanced": true,
      "placeholder": "100"
    },
    "recencyWeight": {
      "label": "Recency Weight",
      "advanced": true,
      "help": "How much to boost recent memories in search (0-1)",
      "placeholder": "0.2"
    },
    "boostAccessCount": {
      "label": "Boost Frequent Access",
      "help": "Rank frequently accessed memories higher in search"
    },
    "negativeExamplesEnabled": {
      "label": "Negative Examples",
      "help": "Track retrieved-but-not-useful memories and apply a small ranking penalty (optional)"
    },
    "negativeExamplesPenaltyPerHit": {
      "label": "Negative Penalty / Hit",
      "advanced": true,
      "placeholder": "0.05"
    },
    "negativeExamplesPenaltyCap": {
      "label": "Negative Penalty Cap",
      "advanced": true,
      "placeholder": "0.25"
    },
    "chunkingEnabled": {
      "label": "Enable Chunking",
      "help": "Automatically split long memories into overlapping chunks for better retrieval"
    },
    "chunkingTargetTokens": {
      "label": "Chunk Target Tokens",
      "advanced": true,
      "placeholder": "200"
    },
    "chunkingMinTokens": {
      "label": "Chunk Min Tokens",
      "advanced": true,
      "placeholder": "150"
    },
    "chunkingOverlapSentences": {
      "label": "Chunk Overlap Sentences",
      "advanced": true,
      "placeholder": "2"
    },
    "contradictionDetectionEnabled": {
      "label": "Contradiction Detection",
      "help": "Detect and resolve conflicting memories using LLM verification"
    },
    "contradictionSimilarityThreshold": {
      "label": "Contradiction Similarity Threshold",
      "advanced": true,
      "placeholder": "0.7"
    },
    "contradictionMinConfidence": {
      "label": "Contradiction Min Confidence",
      "advanced": true,
      "placeholder": "0.9"
    },
    "contradictionAutoResolve": {
      "label": "Auto-Resolve Contradictions",
      "help": "Automatically supersede old memories when contradiction is confirmed"
    },
    "memoryLinkingEnabled": {
      "label": "Memory Linking",
      "help": "Build knowledge graph by linking related memories"
    },
    "threadingEnabled": {
      "label": "Conversation Threading",
      "help": "Group memories into conversation threads with auto-titles"
    },
    "threadingGapMinutes": {
      "label": "Thread Gap (minutes)",
      "advanced": true,
      "placeholder": "30"
    },
    "summarizationEnabled": {
      "label": "Memory Summarization",
      "help": "Compress old, low-importance memories into summaries"
    },
    "summarizationTriggerCount": {
      "label": "Summarization Trigger",
      "advanced": true,
      "placeholder": "1000"
    },
    "summarizationRecentToKeep": {
      "label": "Recent to Keep",
      "advanced": true,
      "placeholder": "300"
    },
    "summarizationImportanceThreshold": {
      "label": "Importance Threshold",
      "advanced": true,
      "placeholder": "0.3"
    },
    "topicExtractionEnabled": {
      "label": "Topic Extraction",
      "help": "Extract key topics from memory corpus"
    },
    "topicExtractionTopN": {
      "label": "Top N Topics",
      "advanced": true,
      "placeholder": "50"
    },
    "transcriptEnabled": {
      "label": "Enable Transcript Archive",
      "help": "Archive conversation transcripts for context preservation"
    },
    "transcriptRetentionDays": {
      "label": "Transcript Retention (days)",
      "advanced": true,
      "placeholder": "7"
    },
    "transcriptSkipChannelTypes": {
      "label": "Skip Channel Types",
      "advanced": true,
      "help": "Channel types to exclude from transcript logging (default: cron)"
    },
    "transcriptRecallHours": {
      "label": "Transcript Recall (hours)",
      "advanced": true,
      "placeholder": "12"
    },
    "maxTranscriptTurns": {
      "label": "Max Transcript Turns",
      "advanced": true,
      "placeholder": "50"
    },
    "maxTranscriptTokens": {
      "label": "Max Transcript Tokens",
      "advanced": true,
      "placeholder": "1000"
    },
    "checkpointEnabled": {
      "label": "Enable Checkpoints",
      "help": "Capture conversation checkpoints for resuming context"
    },
    "checkpointTurns": {
      "label": "Checkpoint Turn Interval",
      "advanced": true,
      "placeholder": "15"
    },
    "hourlySummariesEnabled": {
      "label": "Enable Hourly Summaries",
      "help": "Generate hourly summaries of conversation activity"
    },
    "summaryRecallHours": {
      "label": "Summary Recall (hours)",
      "advanced": true,
      "placeholder": "24"
    },
    "maxSummaryCount": {
      "label": "Max Summary Count",
      "advanced": true,
      "placeholder": "6"
    },
    "summaryModel": {
      "label": "Summary Model",
      "advanced": true,
      "placeholder": "(same as extraction model)"
    },
    "localLlmEnabled": {
      "label": "Enable Local LLM",
      "help": "Use local LLM (LM Studio, Ollama, etc.) for extraction and summaries. Falls back to OpenAI if unavailable."
    },
    "localLlmUrl": {
      "label": "Local LLM URL",
      "advanced": true,
      "placeholder": "http://localhost:1234/v1",
      "help": "OpenAI-compatible endpoint URL for local LLM"
    },
    "localLlmModel": {
      "label": "Local LLM Model",
      "advanced": true,
      "placeholder": "local-model",
      "help": "Model identifier for local LLM requests"
    },
    "localLlmApiKey": {
      "label": "Local LLM API Key",
      "advanced": true,
      "sensitive": true,
      "placeholder": "sk-...",
      "help": "Optional API key for authenticated OpenAI-compatible endpoints"
    },
    "localLlmHeaders": {
      "label": "Local LLM Headers",
      "advanced": true,
      "help": "Optional extra headers for provider-specific routing/auth"
    },
    "localLlmAuthHeader": {
      "label": "Send Auth Header",
      "advanced": true,
      "help": "When false, do not send Authorization header even if localLlmApiKey is set"
    },
    "localLlmFallback": {
      "label": "Local LLM Fallback",
      "advanced": true,
      "help": "Fall back to cloud OpenAI if local LLM fails or is unavailable"
    },
    "localLlmHomeDir": {
      "label": "Local LLM Home Dir",
      "advanced": true,
      "placeholder": "(auto: HOME / os.homedir)",
      "help": "Optional home directory override for LM Studio settings and local helper paths."
    },
    "localLmsCliPath": {
      "label": "LMS CLI Path",
      "advanced": true,
      "placeholder": "/path/to/lms",
      "help": "Optional absolute path to LMS CLI. Overrides auto-detection."
    },
    "localLmsBinDir": {
      "label": "LMS Bin Dir",
      "advanced": true,
      "placeholder": "/path/to/bin",
      "help": "Optional bin directory prepended to PATH for LMS CLI execution."
    },
    "localLlmMaxContext": {
      "label": "Local LLM Max Context",
      "advanced": true,
      "placeholder": "(auto-detected from model)",
      "help": "Override context window if your LLM server uses smaller default (e.g., 32768 for LM Studio default)"
    },
    "factDeduplicationEnabled": {
      "label": "Fact Deduplication",
      "help": "Prevent storing semantically identical facts using content hashing"
    },
    "factArchivalEnabled": {
      "label": "Fact Archival",
      "help": "Automatically archive old, low-importance, rarely-accessed facts during consolidation"
    },
    "factArchivalAgeDays": {
      "label": "Archival Age (days)",
      "advanced": true,
      "placeholder": "90"
    },
    "factArchivalMaxImportance": {
      "label": "Archival Max Importance",
      "advanced": true,
      "placeholder": "0.3"
    },
    "factArchivalMaxAccessCount": {
      "label": "Archival Max Access Count",
      "advanced": true,
      "placeholder": "2"
    },
    "factArchivalProtectedCategories": {
      "label": "Archival Protected Categories",
      "advanced": true,
      "help": "Categories that are never archived regardless of age or importance"
    },
    "knowledgeIndexEnabled": {
      "label": "Knowledge Index",
      "help": "Inject a compact table of top entities into every recall"
    },
    "knowledgeIndexMaxEntities": {
      "label": "Knowledge Index Max Entities",
      "advanced": true,
      "placeholder": "40"
    },
    "knowledgeIndexMaxChars": {
      "label": "Knowledge Index Max Chars",
      "advanced": true,
      "placeholder": "4000"
    },
    "entityRelationshipsEnabled": {
      "label": "Entity Relationships",
      "help": "Track entity-to-entity relationships during extraction"
    },
    "entityActivityLogEnabled": {
      "label": "Entity Activity Log",
      "help": "Log timestamped activity per entity"
    },
    "entityActivityLogMaxEntries": {
      "label": "Activity Log Max Entries",
      "advanced": true,
      "placeholder": "20"
    },
    "entityAliasesEnabled": {
      "label": "Entity Aliases",
      "help": "Store aliases per entity file"
    },
    "entitySummaryEnabled": {
      "label": "Entity Summaries",
      "help": "Generate LLM summaries for entities during consolidation"
    }
  }
}
